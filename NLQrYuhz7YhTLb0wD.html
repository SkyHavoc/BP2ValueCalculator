<html><head><base href="." />
<meta charset="UTF-8">
<title>Product Price Calculator</title>
<style>
    :root {
        --bg-color: #f0f2f5;
        --card-bg: white;
        --text-color: #333;
        --shadow-color: rgba(0,0,0,0.1);
        --price-color: #333;
    }

    [data-theme="dark"] {
        --bg-color: #1a1a1a;
        --card-bg: #2d2d2d;
        --text-color: #ffffff;
        --shadow-color: rgba(0,0,0,0.3);
        --price-color: #ffffff;
    }

    body {
        font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        max-width: 800px;
        margin: 0 auto;
        padding: 20px;
        background: var(--bg-color);
        color: var(--text-color);
        transition: background-color 0.3s, color 0.3s;
        padding-bottom: 100px; /* Added padding to account for fixed total box */
    }

    .search-container {
        margin: 20px 0;
        text-align: center;
    }

    .search-input {
        width: 80%;
        max-width: 400px;
        padding: 10px 15px;
        border: 2px solid #2196F3;
        border-radius: 25px;
        font-size: 16px;
        outline: none;
        background: var(--card-bg);
        color: var(--text-color);
        transition: all 0.3s ease;
    }

    .search-input:focus {
        box-shadow: 0 0 5px #2196F3;
    }

    .product-grid {
        display: grid;
        grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
        gap: 20px;
        margin-bottom: 80px; /* Increased margin to prevent overlap with total box */
    }

    .product-card {
        background: var(--card-bg);
        border-radius: 10px;
        padding: 15px;
        box-shadow: 0 2px 5px var(--shadow-color);
        transition: transform 0.2s, background-color 0.3s;
    }

    .product-card:hover {
        transform: translateY(-5px);
    }

    .product-icon {
        width: 100%;
        height: 100px;
        margin-bottom: 10px;
        object-fit: contain; /* This ensures the image maintains its aspect ratio */
    }

    .total-display {
        position: fixed; /* Changed from sticky to fixed */
        bottom: 0;
        left: 0;
        right: 0;
        background: var(--card-bg);
        padding: 20px;
        box-shadow: 0 -2px 10px var(--shadow-color);
        text-align: center;
        transition: background-color 0.3s;
        z-index: 1000; /* Ensure it stays on top */
    }

    .quantity-control {
        display: flex;
        align-items: center;
        gap: 10px;
        margin-top: 10px;
    }

    button {
        background: #2196F3;
        color: white;
        border: none;
        padding: 5px 10px;
        border-radius: 5px;
        cursor: pointer;
    }

    button:hover {
        background: #1976D2;
    }

    .theme-toggle {
        position: fixed;
        top: 20px;
        right: 20px;
        padding: 10px 20px;
        background: #2196F3;
        color: white;
        border-radius: 20px;
        cursor: pointer;
        border: none;
        transition: background-color 0.3s;
    }

    .theme-toggle:hover {
        background: #1976D2;
    }

    .quantity {
        font-weight: bold;
    }

    h2 {
        color: var(--text-color);
        margin-bottom: 20px;
        text-align: center;
    }

    .price {
        color: var(--price-color);
        font-weight: bold;
        font-size: 1.2em;
        transition: color 0.3s;
    }

    .total {
        font-size: 1.5em;
        font-weight: bold;
        color: #2196F3;
    }

    .hidden {
        display: none !important;
    }

    .serial-input {
        width: 100%;
        padding: 8px;
        margin-top: 10px;
        border: 1px solid #2196F3;
        border-radius: 5px;
        background: var(--card-bg);
        color: var(--text-color);
        outline: none;
        transition: all 0.3s ease;
    }

    .serial-input:focus {
        border-color: #1976D2;
        box-shadow: 0 0 3px #2196F3;
    }

    .checkbox-group {
        display: grid;
        grid-template-columns: repeat(2, 1fr);
        gap: 5px;
        margin: 10px 0;
    }

    .checkbox-label {
        display: flex;
        align-items: center;
        gap: 5px;
        font-size: 0.9em;
        color: var(--text-color);
    }

    .checkbox-input {
        accent-color: #2196F3;
        cursor: pointer;
    }

    .category-tabs {
        margin: 20px 0;
    }

    .category-header {
        background: var(--card-bg);
        padding: 15px;
        margin: 10px 0;
        border-radius: 10px;
        cursor: pointer;
        display: flex;
        justify-content: space-between;
        align-items: center;
        box-shadow: 0 2px 5px var(--shadow-color);
        transition: background-color 0.3s;
    }

    .category-header:hover {
        background: var(--bg-color);
    }

    .category-content {
        display: none;
        margin: 10px 0;
    }

    .category-content.active {
        display: block;
    }

    .arrow {
        transition: transform 0.3s;
    }

    .arrow.active {
        transform: rotate(180deg);
    }

    .level-control {
        display: flex;
        align-items: center;
        gap: 10px;
        margin-top: 10px;
    }

    .level-input {
        width: 60px;
        padding: 5px;
        border: 1px solid #2196F3;
        border-radius: 5px;
        background: var(--card-bg);
        color: var(--text-color);
        outline: none;
        transition: all 0.3s ease;
    }

    .level-input:focus {
        border-color: #1976D2;
        box-shadow: 0 0 3px #2196F3;
    }

    .level-error {
        border-color: #ff0000;
    }
</style>
</head>
<body>
    <button class="theme-toggle" onclick="toggleTheme()">ðŸŒ“ Toggle Theme</button>
    <h2>Product Price Calculator</h2>
    <div class="search-container">
        <input type="text" class="search-input" placeholder="Search products..." onkeyup="searchProducts(this.value)">
    </div>
    <div class="total-display">
        <h3>Total: <span class="total" id="totalCost">$0.00</span></h3>
    </div>
    <div class="category-tabs" id="products">
        <!-- Products will be dynamically inserted here -->
    </div>

    <script>
        const products = {
            contraband: [
                { id: 1, name: 'Dark Matter Rifle', price: 140000000, color: '#9932CC' },
                { id: 2, name: 'Lightweight Minigun', price: 110000000, color: '#4169E1' },
                { id: 3, name: 'The Cobra', price: 100000000, color: '#228B22' },
                { id: 4, name: 'Silenced Pistol', price: 90000000, color: '#708090' },
                { id: 5, name: 'Thermal Sniper', price: 45000000, color: '#DC143C' },
                { id: 6, name: 'Spring-loaded Minigun', price: 30000000, color: '#FF8C00' }
            ],
            legendary: [
                { id: 7, name: '24K Rifle', price: 799.99, color: '#FFD700' },
                { id: 8, name: '24K Sniper', price: 799.99, color: '#FFD700' },
                { id: 9, name: '24K Minigun', price: 799.99, color: '#FFD700' },
                { id: 10, name: 'Starfall Rifle', price: 799.99, color: '#4B0082' },
                { id: 11, name: 'Starfall Sniper', price: 799.99, color: '#4B0082' },
                { id: 12, name: 'Starfall Minigun', price: 799.99, color: '#4B0082' },
                { id: 13, name: 'Spitfire Rifle', price: 799.99, color: '#FF4500' },
                { id: 14, name: 'Spitfire Sniper', price: 799.99, color: '#FF4500' },
                { id: 15, name: 'Spitfire Minigun', price: 799.99, color: '#FF4500' },
                { id: 16, name: 'Futura Rifle', price: 799.99, color: '#00CED1' },
                { id: 17, name: 'Futura Sniper', price: 799.99, color: '#00CED1' },
                { id: 18, name: 'Futura Minigun', price: 799.99, color: '#00CED1' },
                { id: 19, name: 'Elite Rifle', price: 799.99, color: '#4169E1' },
                { id: 20, name: 'Elite Sniper', price: 799.99, color: '#4169E1' },
                { id: 21, name: 'Elite Minigun', price: 799.99, color: '#4169E1' },
                { id: 22, name: 'Ryu Rifle', price: 799.99, color: '#DC143C' },
                { id: 23, name: 'Ryu Sniper', price: 799.99, color: '#DC143C' },
                { id: 24, name: 'Ryu Minigun', price: 799.99, color: '#DC143C' },
                { id: 25, name: 'Lovebomb Rifle', price: 799.99, color: '#FF69B4' },
                { id: 26, name: 'Lovebomb Sniper', price: 799.99, color: '#FF69B4' },
                { id: 27, name: 'Lovebomb Minigun', price: 799.99, color: '#FF69B4' },
                { id: 28, name: 'Money Rifle', price: 799.99, color: '#32CD32' },
                { id: 29, name: 'Money Sniper', price: 799.99, color: '#32CD32' },
                { id: 30, name: 'Money Minigun', price: 799.99, color: '#32CD32' },
                { id: 31, name: 'Money Gun', price: 799.99, color: '#32CD32' }
            ],
            epic: [
                { id: 32, name: 'Asiimov', price: 499.99, color: '#FF4500' },
                { id: 33, name: 'Hyper Beast', price: 399.99, color: '#8A2BE2' }
            ],
            rare: [
                { id: 34, name: 'Redline', price: 199.99, color: '#DC143C' },
                { id: 35, name: 'Lightning Strike', price: 299.99, color: '#4169E1' }
            ]
        };

        const quantities = new Map();
        const serials = new Map();
        const checkboxStates = new Map();
        const levels = new Map();
        const maxLevels = {
            contraband: 50,
            legendary: 35,
            epic: 35,
            rare: 35
        };

        function formatPrice(price) {
            if (price >= 1000000000) {  // If price is 1 billion or more
                return `$${(price / 1000000000).toFixed(2)}B`;
            } else if (price >= 1000000) {
                return `$${(price / 1000000).toFixed(2)}M`;
            }
            return `$${price.toFixed(2)}`;
        }

        function createProductCard(product, category) {
            const card = document.createElement('div');
            card.className = 'product-card';
            
            let productContent;
            if (product.name === 'Dark Matter Rifle') {
                productContent = `<img src="/a/cb9068c2-6d81-4af1-9668-7580e9938f0c" class="product-icon" alt="Dark Matter Rifle">`;
            } else if (product.name === 'Lightweight Minigun') {
                productContent = `<img src="/a/84e4d89e-8cb4-453b-b0be-6733e7bf69c3" class="product-icon" alt="Lightweight Minigun">`;
            } else if (product.name === 'Starfall Rifle') {
                productContent = `<img src="/a/487b3adc-1217-4fb6-a604-bdea1e2cf4fc" class="product-icon" alt="Starfall Rifle">`;
            } else if (product.name === 'Starfall Sniper') {
                productContent = `<img src="/a/8ac226cc-055c-4454-be3d-5e6d3ea05812" class="product-icon" alt="Starfall Sniper">`;
            } else if (product.name === 'Starfall Minigun') {
                productContent = `<img src="/a/d16f77cc-fdd2-440d-a9d3-a3fd88a040ae" class="product-icon" alt="Starfall Minigun">`;
            } else if (product.name === 'The Cobra') {
                productContent = `<img src="/a/28a75e69-98b6-4c1b-81c7-cee8798684f8" class="product-icon" alt="The Cobra">`;
            } else if (product.name === 'Silenced Pistol') {
                productContent = `<img src="/a/446fe608-d739-4528-8351-866a675bd30d" class="product-icon" alt="Silenced Pistol">`;
            } else if (product.name === 'Thermal Sniper') {
                productContent = `<img src="/a/11815498-36cb-4503-9eba-84e380387709" class="product-icon" alt="Thermal Sniper">`;
            } else if (product.name === 'Spring-loaded Minigun') {
                productContent = `<img src="/a/a8ca8436-82a5-4694-93d5-0ad918a586cb" class="product-icon" alt="Spring-loaded Minigun">`;
            } else if (product.name === 'Spitfire Rifle') {
                productContent = `<img src="/a/8c29a30c-8f81-45a2-879a-bbeca72e52e3" class="product-icon" alt="Spitfire Rifle">`;
            } else if (product.name === 'Spitfire Sniper') {
                productContent = `<img src="/a/771ed2bd-01e2-41db-a405-52a516d35018" class="product-icon" alt="Spitfire Sniper">`;
            } else if (product.name === 'Spitfire Minigun') {
                productContent = `<img src="/a/1b61266e-e526-4c3f-99de-25ef1adf550b" class="product-icon" alt="Spitfire Minigun">`;
            } else if (product.name === '24K Rifle') {
                productContent = `<img src="/a/d012ccdc-739f-428b-8717-cbbc50773e2c" class="product-icon" alt="24K Rifle">`;
            } else if (product.name === '24K Sniper') {
                productContent = `<img src="/a/43b5d474-fa93-4a88-99f7-ed8cadec317c" class="product-icon" alt="24K Sniper">`;
            } else if (product.name === '24K Minigun') {
                productContent = `<img src="/a/e4507dde-a442-474d-9169-4ee48515403a" class="product-icon" alt="24K Minigun">`;
            } else if (product.name === 'Futura Rifle') {
                productContent = `<img src="/a/85f88474-7f1e-4ad6-8235-47839a221563" class="product-icon" alt="Futura Rifle">`;
            } else if (product.name === 'Futura Sniper') {
                productContent = `<img src="/a/556f3693-48c4-40ac-a902-f8532d30a9f0" class="product-icon" alt="Futura Sniper">`;
            } else if (product.name === 'Futura Minigun') {
                productContent = `<img src="/a/9b64370e-fcd1-40ae-9962-d8872f593484" class="product-icon" alt="Futura Minigun">`;
            } else if (product.name === 'Elite Rifle') {
                productContent = `<img src="/a/da108ab5-a97a-4e79-ad33-49514373288e" class="product-icon" alt="Elite Rifle">`;
            } else if (product.name === 'Elite Sniper') {
                productContent = `<img src="/a/ab92a4ba-291a-4c13-a493-8e979afbae93" class="product-icon" alt="Elite Sniper">`;
            } else if (product.name === 'Elite Minigun') {
                productContent = `<img src="/a/51b2ddc4-5015-43d6-b7c0-05f79c37863e" class="product-icon" alt="Elite Minigun">`;
            } else if (product.name === 'Ryu Rifle') {
                productContent = `<img src="/a/50cb1d56-299a-4851-95fd-6c06b01ac594" class="product-icon" alt="Ryu Rifle">`;
            } else if (product.name === 'Ryu Sniper') {
                productContent = `<img src="/a/5e6ce9e4-91ae-4542-930f-77717a6bcd7c" class="product-icon" alt="Ryu Sniper">`;
            } else if (product.name === 'Ryu Minigun') {
                productContent = `<img src="/a/1d7f81da-03db-45fa-a381-54b1bd9a2018" class="product-icon" alt="Ryu Minigun">`;
            } else {
                productContent = `<svg class="product-icon" viewBox="0 0 100 100">
                    <rect width="100" height="100" fill="${product.color}" opacity="0.2"/>
                    <text x="50" y="50" text-anchor="middle" dominant-baseline="middle" 
                        fill="${product.color}" font-size="14">${product.name}</text>
                </svg>`;
            }
            
            const maxLevel = maxLevels[category];
            
            card.innerHTML = `
                ${productContent}
                <h3>${product.name}</h3>
                <p class="price" id="price-${product.id}">${formatPrice(product.price)}</p>
                <div class="level-control">
                    <label>Level:</label>
                    <input type="number" 
                        class="level-input" 
                        id="level-${product.id}" 
                        min="1" 
                        max="${maxLevel}" 
                        value="1"
                        onchange="updateLevel(${product.id}, this.value, ${maxLevel})"
                        oninput="validateLevel(this, ${maxLevel})">
                </div>
                <input type="number" 
                    class="serial-input" 
                    id="serial-${product.id}" 
                    placeholder="Enter serial number (optional)" 
                    min="1" 
                    step="1"
                    onchange="updateSerial(${product.id}, this.value)"
                    oninput="this.value = this.value.replace(/[^0-9]/g, '')">
                <div class="checkbox-group">
                    <label class="checkbox-label">
                        <input type="checkbox" class="checkbox-input" 
                            onchange="updateCheckboxState(${product.id}, 'tags', this.checked)">
                        Tags
                    </label>
                    <label class="checkbox-label">
                        <input type="checkbox" class="checkbox-input"
                            onchange="updateCheckboxState(${product.id}, 'studs', this.checked)">
                        Studs
                    </label>
                    <label class="checkbox-label">
                        <input type="checkbox" class="checkbox-input"
                            onchange="updateCheckboxState(${product.id}, 'minutes', this.checked)">
                        Minutes
                    </label>
                    <label class="checkbox-label">
                        <input type="checkbox" class="checkbox-input"
                            onchange="updateCheckboxState(${product.id}, 'bullets', this.checked)">
                        Bullets
                    </label>
                </div>
                <div class="quantity-control">
                    <button onclick="updateQuantity(${product.id}, -1)">-</button>
                    <span class="quantity" id="quantity-${product.id}">0</span>
                    <button onclick="updateQuantity(${product.id}, 1)">+</button>
                </div>
            `;
            return card;
        }

        function validateLevel(input, maxLevel) {
            const value = parseInt(input.value);
            if (value < 1) {
                input.value = 1;
            } else if (value > maxLevel) {
                input.value = maxLevel;
            }
            input.classList.toggle('level-error', value < 1 || value > maxLevel);
            
            const productId = parseInt(input.id.replace('level-', ''));
            updateLevel(productId, input.value, maxLevel);
        }

        function updateLevel(productId, level, maxLevel) {
            level = parseInt(level);
            if (level < 1) level = 1;
            if (level > maxLevel) level = maxLevel;
            levels.set(productId, level);
            document.getElementById(`level-${productId}`).value = level;
            
            const product = Object.values(products).flat().find(p => p.id === productId);
            const serial = serials.get(productId);
            
            const isContraband = Object.entries(products).find(([category, items]) => 
                items.find(item => item.id === productId) && category === 'contraband'
            );
            
            let serialMultiplier = 1;
            if (serial) {
                if (isContraband) {
                    serialMultiplier = -2 * Math.log(serial) + 17;
                } else {
                    serialMultiplier = -0.4 * Math.log(serial) + 3.6;
                }
            }
            
            const levelMultiplier = 1 + (0.5 * ((level - 1) / (maxLevel - 1)));
            
            const adjustedPrice = product.price * levelMultiplier * serialMultiplier;
            document.getElementById(`price-${product.id}`).textContent = formatPrice(adjustedPrice);
            
            if (quantities.has(productId)) {
                updateDisplay();
            }
        }

        function toggleCategory(category) {
            const content = document.getElementById(`${category}-content`);
            const arrow = content.previousElementSibling.querySelector('.arrow');
            
            content.classList.toggle('active');
            arrow.classList.toggle('active');
        }

        function updateCheckboxState(productId, type, checked) {
            if (!checkboxStates.has(productId)) {
                checkboxStates.set(productId, new Map());
            }
            const productCheckboxes = checkboxStates.get(productId);
            productCheckboxes.set(type, checked);
            
            // Recalculate price after checkbox change
            recalculatePrice(productId);
        }

        function getStatMultiplier(productId) {
            if (!checkboxStates.has(productId)) {
                return 1;
            }
            
            const checkedCount = Array.from(checkboxStates.get(productId).values())
                .filter(checked => checked).length;
            
            switch(checkedCount) {
                case 1: return 1.05;
                case 2: return 1.1;
                case 3: return 1.5;
                case 4: return 2;
                default: return 1;
            }
        }

        function recalculatePrice(productId) {
            const product = Object.values(products).flat().find(p => p.id === productId);
            const level = levels.get(productId) || 1;
            const serial = serials.get(productId);
            
            const isContraband = Object.entries(products).find(([category, items]) => 
                items.find(item => item.id === productId) && category === 'contraband'
            );
            
            const maxLevel = isContraband ? 50 : 35;
            
            let serialMultiplier = 1;
            if (serial) {
                if (isContraband) {
                    serialMultiplier = -2 * Math.log(serial) + 17;
                } else {
                    serialMultiplier = -0.4 * Math.log(serial) + 3.6;
                }
            }
            
            const levelMultiplier = 1 + (0.5 * ((level - 1) / (maxLevel - 1)));
            const statMultiplier = getStatMultiplier(productId);
            
            const adjustedPrice = product.price * levelMultiplier * serialMultiplier * statMultiplier;
            
            if (serial && serial >= 1 && serial <= 25) {
                document.getElementById(`price-${product.id}`).textContent = 'Owners Choice';
            } else {
                document.getElementById(`price-${product.id}`).textContent = formatPrice(adjustedPrice);
            }
            
            if (quantities.has(productId)) {
                updateDisplay();
            }
        }

        function searchProducts(searchTerm) {
            const cards = document.querySelectorAll('.product-card');
            searchTerm = searchTerm.toLowerCase();
            
            cards.forEach(card => {
                const productName = card.querySelector('h3').textContent.toLowerCase();
                if (productName.includes(searchTerm)) {
                    card.classList.remove('hidden');
                    const categoryContent = card.closest('.category-content');
                    categoryContent.classList.add('active');
                    categoryContent.previousElementSibling.querySelector('.arrow').classList.add('active');
                } else {
                    card.classList.add('hidden');
                }
            });
        }

        function toggleTheme() {
            const body = document.body;
            const currentTheme = body.getAttribute('data-theme');
            if (currentTheme === 'dark') {
                body.removeAttribute('data-theme');
            } else {
                body.setAttribute('data-theme', 'dark');
            }
        }

        function updateSerial(productId, serialNumber) {
            if (serialNumber.trim() === '') {
                serials.delete(productId);
            } else {
                const serialNum = parseFloat(serialNumber);
                if (!isNaN(serialNum) && serialNum > 0) {
                    serials.set(productId, serialNum);
                } else {
                    serials.delete(productId);
                }
            }
            
            const product = Object.values(products).flat().find(p => p.id === productId);
            const level = levels.get(productId) || 1;
            const serial = serials.get(productId);
            
            if (serial && serial >= 1 && serial <= 25) {
                document.getElementById(`price-${product.id}`).textContent = 'Owners Choice';
            } else {
                const isContraband = Object.entries(products).find(([category, items]) => 
                    items.find(item => item.id === productId) && category === 'contraband'
                );
                const maxLevel = isContraband ? 50 : 35;
                
                let serialMultiplier = 1;
                if (serial) {
                    if (isContraband) {
                        serialMultiplier = -2 * Math.log(serial) + 17;
                    } else {
                        serialMultiplier = -0.4 * Math.log(serial) + 3.6;
                    }
                }
                
                const levelMultiplier = 1 + (0.5 * ((level - 1) / (maxLevel - 1)));
                const adjustedPrice = product.price * levelMultiplier * serialMultiplier;
                document.getElementById(`price-${product.id}`).textContent = formatPrice(adjustedPrice);
            }
            
            if (quantities.has(productId)) {
                updateDisplay();
            }
        }

        function updateQuantity(productId, change) {
            const currentQuantity = quantities.get(productId) || 0;
            const newQuantity = Math.max(0, currentQuantity + change);
            
            if (newQuantity === 0) {
                quantities.delete(productId);
            } else {
                quantities.set(productId, newQuantity);
            }
            
            updateDisplay();
        }

        function updateDisplay() {
            quantities.forEach((quantity, productId) => {
                document.getElementById(`quantity-${productId}`).textContent = quantity;
            });
            
            Object.values(products).flat().forEach(product => {
                if (!quantities.has(product.id)) {
                    document.getElementById(`quantity-${product.id}`).textContent = '0';
                }
            });

            let totalCost = 0;
            let ocCount = 0;
            let regularTotal = 0;
            
            quantities.forEach((quantity, productId) => {
                const product = Object.values(products).flat().find(p => p.id === productId);
                const level = levels.get(productId) || 1;
                const serial = serials.get(productId);
                
                let maxLevel = 35;
                let serialMultiplier = 1;
                
                const isContraband = Object.entries(products).find(([category, items]) => 
                    items.find(item => item.id === productId) && category === 'contraband'
                );
                
                if (isContraband) {
                    maxLevel = 50;
                }
                
                const levelMultiplier = 1 + (0.5 * ((level - 1) / (maxLevel - 1)));
                const statMultiplier = getStatMultiplier(productId);
                
                const isOC = serial && serial >= 1 && serial <= 25;
                
                if (isOC) {
                    ocCount += quantity;
                    document.getElementById(`price-${product.id}`).textContent = 'Owners Choice';
                } else {
                    if (serial) {
                        serialMultiplier = isContraband ? 
                            (-2 * Math.log(serial) + 17) : 
                            (-0.4 * Math.log(serial) + 3.6);
                    }
                    const adjustedPrice = product.price * levelMultiplier * serialMultiplier * statMultiplier;
                    document.getElementById(`price-${product.id}`).textContent = 
                        formatPrice(adjustedPrice);
                    regularTotal += adjustedPrice * quantity;
                }
            });

            let totalDisplay = '';
            if (ocCount > 0) {
                if (ocCount > 1) {
                    totalDisplay += `${ocCount}xOC`;
                } else {
                    totalDisplay += 'OC';
                }
                if (regularTotal > 0) {
                    totalDisplay += ` + ${formatPrice(regularTotal)}`;
                }
            } else {
                totalDisplay = formatPrice(regularTotal);
            }

            document.getElementById('totalCost').textContent = totalDisplay;
        }

        const productGrid = document.getElementById('products');
        Object.entries(products).forEach(([category, items]) => {
            const categorySection = document.createElement('div');
            categorySection.className = 'category-section';
            
            categorySection.innerHTML = `
                <div class="category-header" onclick="toggleCategory('${category}')">
                    <h3>${category.charAt(0).toUpperCase() + category.slice(1)}</h3>
                    <span class="arrow">â†“</span>
                </div>
                <div class="category-content" id="${category}-content">
                    <div class="product-grid">
                        ${items.map(product => createProductCard(product, category).outerHTML).join('')}
                    </div>
                </div>
            `;
            
            productGrid.appendChild(categorySection);
        });
    </script>
</body>
</html>